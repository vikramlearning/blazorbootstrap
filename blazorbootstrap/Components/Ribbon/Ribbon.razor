@namespace BlazorBootstrap
@inherits BlazorBootstrapComponentBase

<CascadingValue Value="this" Name="Ribbon1" IsFixed="true">
    @if (ChildContent != null)
    {
        @ChildContent
    }
</CascadingValue>

@if (tabs?.Any() ?? false)
{
    var ribbonClass = NavStyle switch
    {
        NavStyle.Pills or NavStyle.VerticalPills => BootstrapClass.NavPills,
        NavStyle.Tabs => BootstrapClass.NavTabs,
        NavStyle.Underline or NavStyle.VerticalUnderline => BootstrapClass.NavUnderline,
        _ => ""
    };
    var isVertical = NavStyle is NavStyle.Vertical or NavStyle.VerticalPills or NavStyle.VerticalUnderline;

    <div class="@(isVertical ? "d-flex" : "")">
        <nav>
            <div @ref="@Element" id="@Id" class="@BootstrapClass.Nav @ribbonClass @(isVertical ? BootstrapClass.FlexColumn : "") @Class" @attributes="@AdditionalAttributes" role="tablist">
                @foreach (var t in tabs)
                { 
                    <button class="nav-link @(t.Disabled ? "disabled" : "")" id="@t.Id" data-bs-target="#nav-@t.Id" type="button" role="tab" aria-selected="false" @onclick="async () => await OnTabClickAsync(t)">
                        @if (t.TitleTemplate != null)
                        {
                            @t.TitleTemplate
                        }
                        else if (!string.IsNullOrWhiteSpace(t.Title))
                        {
                            @t.Title
                        }
                        else
                        {
                            <text>No Title</text>
                        }
                    </button>
                }
            </div>
        </nav>
        <div class="@TabContentCssClass">
            @foreach (var t in tabs)
            {
                <div class="tab-pane @(EnableFadeEffect ? "fade" : "")" id="nav-@t.Id" role="tabpanel" aria-labelledby="@t.Id">
                    <div class="d-flex flex-row border">
                        <CascadingValue Value="this" Name="Ribbon2" IsFixed="true">
                            @t.ChildContent
                        </CascadingValue>
                    </div>
                </div>
            }
        </div>
    </div>
}
